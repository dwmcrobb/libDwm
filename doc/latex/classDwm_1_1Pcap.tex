\doxysection{Dwm\+::Pcap Class Reference}
\hypertarget{classDwm_1_1Pcap}{}\label{classDwm_1_1Pcap}\index{Dwm::Pcap@{Dwm::Pcap}}


This is a pcap wrapper/utility class.  




{\ttfamily \#include $<$Dwm\+Pcap.\+hh$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classDwm_1_1Pcap_a50fe1b32acc860037aae65d23daab370}\label{classDwm_1_1Pcap_a50fe1b32acc860037aae65d23daab370} 
{\bfseries Pcap} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\Hypertarget{classDwm_1_1Pcap_a9a4ba00bc04482e589d050b38c54fcd0}\label{classDwm_1_1Pcap_a9a4ba00bc04482e589d050b38c54fcd0} 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Pcap} ()
\begin{DoxyCompactList}\small\item\em Destructor. Will close the contained pcap device if it\textquotesingle{}s open. \end{DoxyCompactList}\item 
\Hypertarget{classDwm_1_1Pcap_a8e5410476a68d8c456ac65c29dd5e189}\label{classDwm_1_1Pcap_a8e5410476a68d8c456ac65c29dd5e189} 
int {\bfseries Set\+Buffer\+Size} (int buffer\+Size)
\item 
bool \mbox{\hyperlink{classDwm_1_1Pcap_ad5d5bc468f90a8184311bcaad28576dd}{Open\+Live}} (const std\+::string \&device, int snaplen, bool promisc, int timeout\+\_\+msecs)
\begin{DoxyCompactList}\small\item\em Open {\ttfamily device} for live packet capture. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classDwm_1_1Pcap_ad177828897ad8a66e0de57517286b794}{Set\+Direction}} (pcap\+\_\+direction\+\_\+t direction)
\begin{DoxyCompactList}\small\item\em Specify whether to capture incoming packets, outgoing packets, or both. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classDwm_1_1Pcap_a2f92b47401a07753d79f5a256a156095}{Open\+Offline}} (const std\+::string \&fname)
\begin{DoxyCompactList}\small\item\em Opens the file {\ttfamily fname} for reading. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classDwm_1_1Pcap_ac290b36d493178a457538ade6dbdd7da}{Set\+Filter}} (const std\+::string \&filter, bool optimize)
\begin{DoxyCompactList}\small\item\em Sets the filter for the capture device. \end{DoxyCompactList}\item 
\Hypertarget{classDwm_1_1Pcap_ad70f46d414cc172105eee965c81d4533}\label{classDwm_1_1Pcap_ad70f46d414cc172105eee965c81d4533} 
int {\bfseries Dispatch} (int count, pcap\+\_\+handler callback, uint8\+\_\+t \texorpdfstring{$\ast$}{*}user)
\begin{DoxyCompactList}\small\item\em A wrapper for pcap\+\_\+dispatch(). See the pcap(3) manpage. \end{DoxyCompactList}\item 
\Hypertarget{classDwm_1_1Pcap_a323899243ffd6edfaf6c76ee56caea3f}\label{classDwm_1_1Pcap_a323899243ffd6edfaf6c76ee56caea3f} 
int {\bfseries Loop} (int count, pcap\+\_\+handler callback, uint8\+\_\+t \texorpdfstring{$\ast$}{*}user)
\begin{DoxyCompactList}\small\item\em A wrapper for pcap\+\_\+loop(). See the pcap(3) manpage. \end{DoxyCompactList}\item 
\Hypertarget{classDwm_1_1Pcap_aebcc77a24c7616226caf7e001e492327}\label{classDwm_1_1Pcap_aebcc77a24c7616226caf7e001e492327} 
void {\bfseries Break\+Loop} ()
\begin{DoxyCompactList}\small\item\em A wrapper for pcap\+\_\+breakloop(). \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classDwm_1_1Pcap_a3989b2dcd3a669dd73b8b80fbe16d66a}{Close}} ()
\begin{DoxyCompactList}\small\item\em Closes the capture device. \end{DoxyCompactList}\item 
\Hypertarget{classDwm_1_1Pcap_a74d5bc2867c9da843e25c4f4356a5a7a}\label{classDwm_1_1Pcap_a74d5bc2867c9da843e25c4f4356a5a7a} 
const std\+::string \& {\bfseries Last\+Error} () const
\begin{DoxyCompactList}\small\item\em Returns the last error string from a failed \doxylink{classDwm_1_1Pcap_ad5d5bc468f90a8184311bcaad28576dd}{Open\+Live()} or \doxylink{classDwm_1_1Pcap_a2f92b47401a07753d79f5a256a156095}{Open\+Offline()} call. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classDwm_1_1Pcap_ab2123733991557fa05b3c3d250189b96}{Data\+Link\+Offset}} () const
\begin{DoxyCompactList}\small\item\em Returns the length of the link layer header for the capture device. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This is a pcap wrapper/utility class. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classDwm_1_1Pcap_a3989b2dcd3a669dd73b8b80fbe16d66a}\index{Dwm::Pcap@{Dwm::Pcap}!Close@{Close}}
\index{Close@{Close}!Dwm::Pcap@{Dwm::Pcap}}
\doxysubsubsection{\texorpdfstring{Close()}{Close()}}
{\footnotesize\ttfamily \label{classDwm_1_1Pcap_a3989b2dcd3a669dd73b8b80fbe16d66a} 
bool Dwm\+::\+Pcap\+::\+Close (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Closes the capture device. 

Returns true if the device was open, false if it was already closed. \Hypertarget{classDwm_1_1Pcap_ab2123733991557fa05b3c3d250189b96}\index{Dwm::Pcap@{Dwm::Pcap}!DataLinkOffset@{DataLinkOffset}}
\index{DataLinkOffset@{DataLinkOffset}!Dwm::Pcap@{Dwm::Pcap}}
\doxysubsubsection{\texorpdfstring{DataLinkOffset()}{DataLinkOffset()}}
{\footnotesize\ttfamily \label{classDwm_1_1Pcap_ab2123733991557fa05b3c3d250189b96} 
int Dwm\+::\+Pcap\+::\+Data\+Link\+Offset (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const}



Returns the length of the link layer header for the capture device. 

This lets us skip over it to get to the network layer. Returns -\/1 if we don\textquotesingle{}t know the length of the link layer header. \Hypertarget{classDwm_1_1Pcap_ad5d5bc468f90a8184311bcaad28576dd}\index{Dwm::Pcap@{Dwm::Pcap}!OpenLive@{OpenLive}}
\index{OpenLive@{OpenLive}!Dwm::Pcap@{Dwm::Pcap}}
\doxysubsubsection{\texorpdfstring{OpenLive()}{OpenLive()}}
{\footnotesize\ttfamily \label{classDwm_1_1Pcap_ad5d5bc468f90a8184311bcaad28576dd} 
bool Dwm\+::\+Pcap\+::\+Open\+Live (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{device}{, }\item[{int}]{snaplen}{, }\item[{bool}]{promisc}{, }\item[{int}]{timeout\+\_\+msecs}{}\end{DoxyParamCaption})}



Open {\ttfamily device} for live packet capture. 

Will capture no more than {\ttfamily snaplen} from each packet. Will set the device in promiscuous mode if {\ttfamily promisc} is true. {\ttfamily timeout\+\_\+msecs} specifies the read timeout in milliseconds. See the pcap(3) manpage for details. Returns true on success, false on failure. \Hypertarget{classDwm_1_1Pcap_a2f92b47401a07753d79f5a256a156095}\index{Dwm::Pcap@{Dwm::Pcap}!OpenOffline@{OpenOffline}}
\index{OpenOffline@{OpenOffline}!Dwm::Pcap@{Dwm::Pcap}}
\doxysubsubsection{\texorpdfstring{OpenOffline()}{OpenOffline()}}
{\footnotesize\ttfamily \label{classDwm_1_1Pcap_a2f92b47401a07753d79f5a256a156095} 
bool Dwm\+::\+Pcap\+::\+Open\+Offline (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{fname}{}\end{DoxyParamCaption})}



Opens the file {\ttfamily fname} for reading. 

Returns true on success, false on failure. \Hypertarget{classDwm_1_1Pcap_ad177828897ad8a66e0de57517286b794}\index{Dwm::Pcap@{Dwm::Pcap}!SetDirection@{SetDirection}}
\index{SetDirection@{SetDirection}!Dwm::Pcap@{Dwm::Pcap}}
\doxysubsubsection{\texorpdfstring{SetDirection()}{SetDirection()}}
{\footnotesize\ttfamily \label{classDwm_1_1Pcap_ad177828897ad8a66e0de57517286b794} 
bool Dwm\+::\+Pcap\+::\+Set\+Direction (\begin{DoxyParamCaption}\item[{pcap\+\_\+direction\+\_\+t}]{direction}{}\end{DoxyParamCaption})}



Specify whether to capture incoming packets, outgoing packets, or both. 

See the pcap(3) manpage for details. Returns true on success, false on failure. Note this function is only supported for live packet captures. \Hypertarget{classDwm_1_1Pcap_ac290b36d493178a457538ade6dbdd7da}\index{Dwm::Pcap@{Dwm::Pcap}!SetFilter@{SetFilter}}
\index{SetFilter@{SetFilter}!Dwm::Pcap@{Dwm::Pcap}}
\doxysubsubsection{\texorpdfstring{SetFilter()}{SetFilter()}}
{\footnotesize\ttfamily \label{classDwm_1_1Pcap_ac290b36d493178a457538ade6dbdd7da} 
bool Dwm\+::\+Pcap\+::\+Set\+Filter (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{filter}{, }\item[{bool}]{optimize}{}\end{DoxyParamCaption})}



Sets the filter for the capture device. 

{\ttfamily filter} is the usual pcap filter string syntax. If {\ttfamily optimize} is true, the resulting compiled filter will be optimized. 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{DwmPcap_8hh}{Dwm\+Pcap.\+hh}}\end{DoxyCompactItemize}
